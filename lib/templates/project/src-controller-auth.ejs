const AuthServ = require("./../services/auth.service");
const { response } = require("./../utils");

class AuthContoller {
  async signup(req, res) {
    const result = await AuthServ.signup(req.body);
    res.status(201).send(response("User signup successful", result));
  }

  async signin(req, res) {
    const result = await AuthServ.signin(req.body);
    res.status(200).send(response("User signin successful", result));
  }

  async requestEmailVerification(req, res) {
    const result = await AuthServ.requestEmailVerification(req.body);
    res.status(200).send(response("Email verfication OTP sent", result));
  }

  async verifyEmail(req, res) {
    const result = await AuthServ.verifyEmail(req.body);
    res.status(200).send(response("Email verification successful", result));
  }

  async requestPasswordReset(req, res) {
    const result = await AuthServ.requestPasswordReset(req.body);
    res.status(200).send(response("Password reset OTP sent", result));
  }

  async resetPassword(req, res) {
    const result = await AuthServ.resetPassword(req.body);
    res.status(200).send(response("Password reset successful", result));
  }

  async updatePassword(req, res) {
    const result = await AuthServ.updatePassword(req.body);
    res.status(200).send(response("Password updated", result));
  }
}

module.exports = new AuthContoller();