/**
 * Generates a random 6(default) digit numerical code
 * @param {number} numOfDigit - Number of digits to be returned
 * @returns A random number with the specified number of digits
 */
function generateOTP(numOfDigit = 6) {
  const nums = [1, 2, 3, 4, 5, 6, 7, 8, 9, 0]
  let otp = 0

  for (let i = 5; i >= numOfDigit; i--) {
    const randNum = Math.floor(Math.random() * nums.length);
    otp += randNum * (10 ** i)
  }

  return otp
}

/**
 * Validate Joi Schema
 * @param {object} schema - Joi schema
 * @param {string | number | object} data - Value to be validated
 * @returns Joi validated data
 */
async function joiValidate(schema, data) {
  try {
    return await schema.validateAsync(data)
  } catch (error) {
    throw error
  }
}

/**
 * Convert a string to a url slug
 * @param {string} str - string to be converted to slug
 * @returns a slugified string
 */
function slugify(str) {
  return str.split(/[\s.]/).join("-").toLowerCase()
}


module.exports = {
  CustomError: require("./custom-error"),
  response: require("./response"),

  generateOTP,
  joiValidate,
  slugify,
}